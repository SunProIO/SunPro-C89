= 短歌を抽出する

前章では啄木の短歌から「文章」を生成しました。
次はここから「短歌」を生成しましょう。

== 短歌形式

今回の短歌復元の試みでは、短歌の形式をターゲットにしてそれを目標に文章を生成するのではなく、
ランダムに生成した文章から、偶然短歌の形式になっているものを抽出するという形式を取っています。
（マシンパワーが許すならそっちのほうが手っ取り早い）

御存知の通り、和歌短歌というのは五七五七七の三十一文字によって構成されます。
つまり適当な場所で区切った場合にこの形式（プラス字余り）に収まればいいのですが、
この区切りはどこで区切ってもいいわけではありません。

例えば、「アーモンドよりココナッツが食べたい」といった文章を
綺麗な定型の俳句だと認識する人はいないでしょう。
これは「アーモンド／より」や「ココナッツ／が」のような単語と単語の境界でも、
文節を構成している語群に切れ目を入れることに無理があるためです。

実際、どこに切れ目を入れるべき（入れていい）か、というのは難しい問題です。
古典的な短歌では、通常の句と句の間の切れ目のほかに、
句切れと呼ばれる大きな内容の切れ目を入れるのが綺麗だとされています。
このあたりは歌風も大きく影響してくることですが、
こと啄木においては、第二章で述べたように句跨がりの多い歌人であることを踏まえ、
単純に文節の切れ目が五七五七七を形成している場合に「短歌」を成しているとみなすことにしました。

== 文節分け

形態素解析した文章を文節に分け、さらなる解析を行うためのソフトウェアとして、
CaboChaなどの係り受け解析エンジンなどが知られていますが、
今回扱うのは通常の現代文と違う近代文語文なので使いづらいですし、
今回は単に文節に分けたいだけなので、より単純なアルゴリズムを採用することにしました。

一般に、一つの文節には一つの自立語が対応します。
自立語とは付属語とともに単語の二大分類のひとつであり、
名詞、動詞、形容詞、接続詞などが含まれます。
つまり、文中の自立語を見つければ、自然に文節の切れ目も見えてきます。

基本的に、見つけた自立語に後続する付属語を追い込むことで文節を形成することができます。
しかし、いくつかの例外があります。

 * 接頭辞は後ろの自立語に追い込む
 * 動詞が連続する場合は連立ごとみなし、ひとつの文節にする
 * 文初の付属語は単独で文節を形成する

これらのルールは、いわゆる単語と形態素の違いに起因するものです。
このルールに従って文節分けを行うと、@<img>{clausization}のように、
入力された短歌から五七五七七の句分けの構造を大観することができます。

//image[clausization][文節分けの一例]{
//}

== 短歌フィルターの実装

今回は、啄木の短歌としてふさわしい形式になっているものを抽出するために、
これらの文節の構造に以下の制約を課しました。

 * 原則として五音・七音・七音の部分で区切れなければならない
 * 字余りは各句について一音まで、全体で二音まで許可する

字余りは初二句ですでに二音の余りがあるため、少なめに設定しました。
啄木の特徴を考えるともう少し増やしてもいいかもしれませんが、
少し増やすと字余りの短歌ばかりが大量に生成されてしまうので、
計算リソースの観点から今回はこの程度にとどめました。

これにより、以下のような短歌が生成されます。

//list[generated-tankaes][マルコフ連鎖から抽出された短歌の一例]{
大跨に 緣側を歩けば いつもいふが 才に過ぎたる 煉瓦遠くより
大跨に 緣側を歩けば とある日に 酒肆の かなしさばかりの
大跨に 緣側を歩けば 湯気が夜の こころ残りを 引っぱりてみて
大跨に 緣側を歩けば 愁ひ知るが かなしき寝覚 かなしき夕と
大跨に 緣側を歩けば うろたへて 山はいかめし 母なきにわれの
大跨に 緣側を歩けば 生命が ままかへり来ぬ 施与をし我の
大跨に 緣側を歩けば 何ぞ成るが 思ひ出の焼くる にほひよ君に
大跨に 緣側を歩けば びっくりして 呼びて人生 終るすべなきか
大跨に 緣側を歩けば 病犬の くもりにゆかむ しかく今年は
大跨に 緣側を歩けば 泣いてああ 酒のむ場所が 我が家なり心
大跨に 緣側を歩けば あをじろき 酔ひてただひとり 泣かまほしさに
大跨に 緣側を歩けば 悲しみが 夜に焼く餅の にほひかなそれを
大跨に 緣側を歩けば 茶碗をこの ままかへり来て 見せなむ踊れと
大跨に 緣側を歩けば 病人の 目をばむしりて くれぬか死なむ
大跨に 緣側を歩けば 君来る この見飽きたる 窓硝子塵と
大跨に 緣側を歩けば 恋ふる心 寄する日なりし バタかな息も
大跨に 緣側を歩けば 茶碗をただ 一度でも胸に ふるさと人に
大跨に 緣側を歩けば 恋ふる心 その音し女 名が何故と
大跨に 緣側を歩けば あをじろき 酔ひざめの青き 疲れて猶目に
大跨に 緣側を歩けば 身体を 敵目が咲かせし 噂を立てし
大跨に 緣側を歩けば 病犬の わが思ふこと なしに帽子を
大跨に 緣側を歩けば 高くなりぬ 顔あり二三 行なれど手を
大跨に 緣側を歩けば 悲しみの 日かへり来て間の そのもどかしさに
大跨に 緣側を歩けば 愁ひ知ると よろこべるかな 長き病を
大跨に 緣側を歩けば 何をのむが 才あまりある 歯せせる女を
大跨に 緣側を歩けば しっとりと 夜霧に清き 大理石川
大跨に 緣側を歩けば おのづから 目を吐くそれに 見えて口笛
大跨に 緣側を歩けば 日光の 遠きひびきに わが学業の
大跨に 緣側を歩けば 安かりし 心にはかに 騒ぐ子ありし
大跨に 緣側を歩けば 田舎めく 顔よかなしき 癖ぞ我かな
大跨に 緣側を歩けば ならむや時 かならずひとつ 起きつ鉢をのむ
大跨に 緣側を歩けば 逃げて丘に 物足らぬその 膝に肺病みし
大跨に 緣側を歩けば 立ち坐り やがてふるさとの こゑ聴きに着物
大跨に 緣側を歩けば その猫が いかにかなりき 三年病の
大跨に 緣側を歩けば わが家のため おもひわづらふ 友共産を
大跨に 緣側を歩けば うたひ出づる まくら時計の 慾に燃ゆる眼を
大跨に 緣側を歩けば 出て松の 並木の岸辺目 さまして蒲団を
大跨に 緣側を歩けば 湯気がごとに 郁雨よ君の したしまぬ目のや
大跨に 緣側を歩けば かなし死に 一人は醒めつ 不思議を横より
大跨に 緣側を歩けば 板軋む かへりけるかな それをはりかへぬ
大跨に 緣側を歩けば 日光の 待つ思ひに火に 暮せるとひょっと
大跨に 緣側を歩けば 病人の 香りにつたふ なみだのごはず
大跨に 緣側を歩けば ゆくりなくも 見まし石だたみ 春生ふる草
大跨に 緣側を歩けば 君が家の かの新聞読む 本の両手を
大跨に 緣側を歩けば 君もこの 咽喉がかわき まだ起きぬ秋
大跨に 緣側を歩けば 悲しみの 声も気焔を 吐きて水のさめ
大跨に 緣側を歩けば おほよその 話声かなと気に なるやはらかき
大跨に 緣側を歩けば おのづから 悪酒の酔ひの 代議士の口に
大跨に 緣側を歩けば あをじろき 酔ひうるみたる 左の色かな
大跨に 緣側を歩けば 日光の なき土地の川に ゆかむ人並の
大跨に 緣側を歩けば 生命が 酒かな今日 逢ひし町ばかり
大跨に 緣側を歩けば うしなひし 人や死にたらむ 踊れと眼閉ぢて
大跨に 緣側を歩けば 茶碗を箸 もて鳥鳴くを 三度この酒と
大跨に 緣側を歩けば 愁ひ知ると いふ人誰が いまは用も三
大跨に 緣側を歩けば ふるさとに 来に曝しかへる 時間となる熱
大跨に 緣側を歩けば うたひ出づる まくら時計の 鳴る磯のひばの
大跨に 緣側を歩けば 逃げてゆきし 石よふるさとに 来し時の月
大跨に 緣側を歩けば すっきりと ひょっと思へと 帰りしかなしみ
大跨に 緣側を歩けば 煙草口 あけし深夜の なまけ者今は
大跨に 緣側を歩けば 恋ふるかの 小庭の土の 外の痍あと
大跨に 緣側を歩けば 胸の中の むかし秀才の 今日逢ひし
大跨に 緣側を歩けば 身体が 癖ぞかし稀に 暮せると冬の
大跨に 緣側を歩けば 寝台の 上に染まりたる 心重れり
大跨に 緣側を歩けば 名のかなしと 争ひし友に 過ぎて消えゆく
大跨に 緣側を歩けば 田舎めく 顔して影も なしさびしくも
大跨に 緣側を歩けば 此処にみぬ あはれなるかなと いのりてし紙鳶の
大跨に 緣側を歩けば 起るてふ 児を聴き倦みたる 心かろくも
大跨に 緣側を歩けば 安かりし よごれたるより 欠伸もよほし
大跨に 緣側を歩けば ならぬごとく かなしみの玉 なみだ誘はるぞ
大跨に 緣側を歩けば かの友みな 己が姿を 秋雨の坂を
大跨に 緣側を歩けば しっとりと 酒肆の 嫁ぎてよこす
大跨に 緣側を歩けば 逃げて伏して 眼ひらく時の 皿など呷らむ
大跨に 緣側を歩けば 胸を薄 月来し師ありき 髯の似たりと
大跨に 緣側を歩けば 病犬の 相を薄月 そのときどき我
大跨に 緣側を歩けば おほよその 霜に手先を 冷やしける小櫛
大跨に 緣側を歩けば ゆくりなく つめたきものの 頬を交して子の
大跨に 緣側を歩けば 指の屑が 波も半ばに 描ける人も
大跨に 緣側を歩けば 田舎めく 旅出て触れしを うれしさ厭ふ
大跨に 緣側を歩けば かの幸 うすきやもめ人 きたなき恋に
大跨に 緣側を歩けば その猫が また争ひの よろしさなどの
大跨に 緣側を歩けば やらむこころ かすめしをさなき 心ひろへる
大跨に 緣側を歩けば 腹立つわが ためぞも誰に さびし烏など
大跨に 緣側を歩けば 立ちて旅 とある小春日の 電車なく砂の
大跨に 緣側を歩けば 逃げて空 仰げばかなしと 啼けばその猫が
大跨に 緣側を歩けば ならむこと 聞けば腹立つ わが世の桜の
大跨に 緣側を歩けば 安かりし 心はまた眼に 帰り来ぬ息
大跨に 緣側を歩けば おほよその わが室に変り つとめ先を箸
大跨に 緣側を歩けば あをじろき 頬に行くそれに 腰掛けし石を
大跨に 緣側を歩けば うしなひし をさなき時も あの頃うまれて
大跨に 緣側を歩けば 恋ふるかと 泊りしからだは すべて謀叛気の
大跨に 緣側を歩けば 名も怒れり 雨の服着て まぢまぢとともに
大跨に 緣側を歩けば わが窓より 山羊と名づけて わが平復を
大跨に 緣側を歩けば 襟よあはれ 長く手とられて 笑ふ三十路の
大跨に 緣側を歩けば しっとりと 眼このごろはよき 事かもひそかに
大跨に 緣側を歩けば 腹立つわが 眠り昔の 恋文めける
大跨に 緣側を歩けば ふるさとに 変りたる地理の かたまりの野にて
大跨に 緣側を歩けば うしなひし をさなき時に 言ひしをさなき
大跨に 緣側を歩けば かの幸 うすきやもめ人 きたなき恋が
大跨に 緣側を歩けば かの村に 迎へし若き あやまちて書いて
大跨に 緣側を歩けば 妹の 卑しさなどの 鬢のつかはぬ
//}

この調子でマルコフ連鎖から抽出した短歌を10000首生成し、
重複を除いた9857首を「最後の一首候補」としました。
ここから「最も啄木らしい」一首を選択します。
